distance = 0

def on_forever():
    global distance
    distance = Tinybit.Ultrasonic_Car()
    if distance > 30:
        Tinybit.car_ctrl_speed(Tinybit.CarState.CAR_RUN, 60)
    else:
        Tinybit.car_ctrl(Tinybit.CarState.CAR_STOP)
        basic.pause(100)
        Tinybit.car_ctrl_speed2(Tinybit.CarState.CAR_RUN, 0, 60)
        basic.pause(400)
        if Tinybit.Ultrasonic_Car() > 20:
            Tinybit.car_ctrl_speed(Tinybit.CarState.CAR_RUN, 60)
        else:
            Tinybit.car_ctrl_speed2(Tinybit.CarState.CAR_RUN, 60, 0)
            basic.pause(400)
            if Tinybit.Ultrasonic_Car() > 20:
                Tinybit.car_ctrl_speed(Tinybit.CarState.CAR_RUN, 60)
            else:
                Tinybit.car_ctrl_speed(Tinybit.CarState.CAR_BACK, 60)
                basic.pause(500)
                Tinybit.car_ctrl(Tinybit.CarState.CAR_STOP)
                basic.pause(300)
basic.forever(on_forever)
